# Cyb3rhq indexer integration


|   |   |
|---|---|
| event.module | cyb3rhq-indexer |
| event.dataset | cyb3rhq-indexer-cluster, cyb3rhq-indexer-deprecation, cyb3rhq-indexer-slowlog, cyb3rhq-indexer-task |

Cyb3rhq indexer module is designed to collect, parse, and analyze logs generated by [Cyb3rhq indexer](https://documentation.wazuh.com/current/getting-started/components/cyb3rhq-indexer.html).
The logs include valuable information for monitoring cluster operations and troubleshooting issues:
  - **Server logs:** These logs record events related to cluster configuration and status, such as changes in cluster topology, node startup or shutdown, shard allocation, etc.
  - **Slow logs:** These logs record operations that exceed certain predefined time thresholds, such as slow searches or slow indexings. Slow logs are useful for identifying and troubleshooting performance issues.
    - Search slow log
    - Indexing slow log
  - **Task logs:** Cyb3rhq indexer can log CPU time and memory utilization for the top N memory-expensive search tasks when task resource consumers are enabled. By default, task resource consumers will log the top 10 search tasks at 60 second intervals.
  - **Deprecation logs:** Deprecation logs record when clients make deprecated API calls to your cluster. These logs can help you identify and fix issues prior to upgrading to a new major version.


## Compatibility

This integration has been tested with Cyb3rhq Indexer logs from version 4.4.

## Configuration


This integration ingests logs from `/var/log/cyb3rhq-indexer` directory (the location of the files can be configured in the localfile configuration).

As mentioned above, we use the logcollector source localfile to ingest the logs from all the files.

Adding to the ossec.conf file in the monitored node the following blocks:
```xml
<localfile>
  <location>/var/log/cyb3rhq-indexer/cyb3rhq-cluster_server.json</location>
  <log_format>json</log_format>
</localfile>

<localfile>
  <location>/var/log/cyb3rhq-indexer/cyb3rhq-cluster_deprecation.json</location>
  <log_format>json</log_format>
</localfile>

<localfile>
  <location>/var/log/cyb3rhq-indexer/cyb3rhq-cluster_index_indexing_slowlog.json</location>
  <log_format>json</log_format>
</localfile>

<localfile>
  <location>/var/log/cyb3rhq-indexer/cyb3rhq-cluster_index_search_slowlog.json</location>
  <log_format>json</log_format>
</localfile>

<localfile>
  <location>/var/log/cyb3rhq-indexer/cyb3rhq-cluster_task_detailslog.log</location>
  <log_format>syslog</log_format>
</localfile>
```


## Schema

## Decoders

| Name | Description |
|---|---|
| decoder/cyb3rhq-indexer-slowlog/0 | Decoder for Cyb3rhq indexer search and indexing slow logs |
| decoder/cyb3rhq-indexer-server/0 | Decoder for Cyb3rhq indexer server logs |
| decoder/cyb3rhq-indexer-task-plain/0 | Decoder for Cyb3rhq indexer task logs in plain text |
| decoder/cyb3rhq-indexer-deprecation/0 | Decoder for Cyb3rhq indexer deprecation logs |
## Rules

| Name | Description |
|---|---|
## Outputs

| Name | Description |
|---|---|
## Filters

| Name | Description |
|---|---|
## Changelog

| Version | Description | Details |
|---|---|---|
| 0.0.1-dev | Created integration for Cyb3rhq indexer | [#17873](https://github.com/cyb3rhq/cyb3rhq/pull/17873) |
